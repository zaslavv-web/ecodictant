<!DOCTYPE html>
<html lang="ru" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Экодиктант - Ожидание</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="dashboard-box curator-wait-screen">
        <img src="hello.png" alt="Acorn Character" style="width: 150px; margin-bottom: 20px;">
        <p id="curator-wait-message"></p>
        <div class="form-group">
            <label for="validationCode" id="validation-code-label" class="centered-label"></label>
            <input type="text" id="validationCode" maxlength="4" style="width: 100px; text-align: center;">
        </div>
        <div class="error-message" id="validation-code-error"></div>
        <button type="button" class="submit-button" id="validate-button"></button>
    </div>
    <script src="locals.js"></script>
    <script src="curators.js"></script>
    <script>
        let currentLang = 'ru';

        function validateSecretCode() {
            const validationCode = document.getElementById('validationCode').value.trim();
            const errorElement = document.getElementById('validation-code-error');
            const existingCurator = curators.find(c => c.code === validationCode);

            if (existingCurator) {
                errorElement.textContent = '';
                const user = JSON.parse(localStorage.getItem('currentUser'));
                if (user) {
                    user.status = 'ready';
                    localStorage.setItem('currentUser', JSON.stringify(user));
                    window.location.href = 'kurator_ready.html';
                }
            } else {
                errorElement.textContent = translations[currentLang].invalid_code;
            }
        }

        window.onload = function() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (user && user.role === 'curator' && user.status === 'waiting') {
                currentLang = user.data.lang || 'ru';
                document.documentElement.lang = currentLang;
                document.documentElement.dir = translations[currentLang].dir || 'ltr';
                document.getElementById('curator-wait-message').textContent = translations[currentLang].curator_wait_message;
                document.getElementById('validation-code-label').textContent = translations[currentLang].validation_code_label;
                document.getElementById('validate-button').textContent = translations[currentLang].register_button;
                document.getElementById('validate-button').addEventListener('click', validateSecretCode);
            } else {
                window.location.href = 'index.html';
            }
        };
    </script>
</body>
</html>